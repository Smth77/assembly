; EXTERNAL DEPENDENCIES
INCLUDE		Irvine32.inc
INCLUDELIB	Irvine32.lib

; EXECUTION MODE PARAMETERS
.386
.model flat, stdcall
.stack 4096

; PROTOTYPES
ExitProcess PROTO, dwExitCode:DWORD

; DATA SEGMENT
.data
    ; Arrays declaration
    sbyte_array SBYTE -2, -1, 0, 1, 2
    sword_array SWORD -11, -12, -13, -14, -15, -16, -17, -18, -19, -20
    sdword_array SDWORD -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40
    dword_array DWORD 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120
    
    ; Strings for display
    title_msg BYTE "Printing Array Elements",0dh,0ah,0
    sbyte_title BYTE "Showing SBYTE Array Elements",0dh,0ah,0
    sword_title BYTE "Showing SWORD Array Elements",0dh,0ah,0
    sdword_title BYTE "Showing SDWORD Array Elements",0dh,0ah,0
    dword_title BYTE "Showing DWORD Array Elements",0dh,0ah,"Using a loop!!!",0dh,0ah,0
    first_last_title BYTE "Showing First and Last",0dh,0ah,0
    
    continue_msg BYTE "Press any key to continue...",0
    asterisk BYTE " *",0

; CODE SEGMENT
.code
main PROC
    ; Initial screen
    mov EDX, OFFSET title_msg
    call WriteString
    call WaitForAnyKey
    call ClearScreen
    
    ; Display SBYTE array
    call DisplaySByteArray
    call WaitForAnyKey
    call ClearScreen
    
    ; Display SWORD array
    call DisplaySWordArray
    call WaitForAnyKey
    call ClearScreen
    
    ; Display SDWORD array
    call DisplaySDWordArray
    call WaitForAnyKey
    call ClearScreen
    
    ; Display DWORD array
    call DisplayDWordArray
    call WaitForAnyKey
    call ClearScreen
    
    ; Display First and Last elements
    call DisplayFirstLast
    call WaitForAnyKey
    
    INVOKE ExitProcess, 0
main ENDP

WaitForAnyKey PROC
    mov EDX, OFFSET continue_msg
    call WriteString
    call Crlf
    call ReadChar
    ret
WaitForAnyKey ENDP

ClearScreen PROC
    mov ECX, 25
ClearLoop:
    call Crlf
    loop ClearLoop
    ret
ClearScreen ENDP

DisplaySByteArray PROC
    mov EDX, OFFSET sbyte_title
    call WriteString
    
    ; Manual offsets - SBYTE array
    movsx EAX, sbyte_array[0]
    call DisplayFormatted
    
    movsx EAX, sbyte_array[1]
    call DisplayFormatted
    
    movsx EAX, sbyte_array[2]
    call DisplayFormatted
    
    movsx EAX, sbyte_array[3]
    call DisplayFormatted
    
    movsx EAX, sbyte_array[4]
    call DisplayFormatted
    ret
DisplaySByteArray ENDP

DisplaySWordArray PROC
    mov EDX, OFFSET sword_title
    call WriteString
    
    ; Manual offset arithmetic (2 bytes each)
    movsx EAX, sword_array[0]    ; -11
    call DisplayFormatted
    movsx EAX, sword_array[2]    ; -12
    call DisplayFormatted
    movsx EAX, sword_array[4]    ; -13
    call DisplayFormatted
    movsx EAX, sword_array[6]    ; -14
    call DisplayFormatted
    movsx EAX, sword_array[8]    ; -15
    call DisplayFormatted
    movsx EAX, sword_array[10]   ; -16
    call DisplayFormatted
    movsx EAX, sword_array[12]   ; -17
    call DisplayFormatted
    movsx EAX, sword_array[14]   ; -18
    call DisplayFormatted
    movsx EAX, sword_array[16]   ; -19
    call DisplayFormatted
    movsx EAX, sword_array[18]   ; -20
    call DisplayFormatted
    ret
DisplaySWordArray ENDP

DisplaySDWordArray PROC
    mov EDX, OFFSET sdword_title
    call WriteString
    
    ; Using TYPE keyword
    mov ESI, 0
    mov ECX, LENGTHOF sdword_array
SDWordLoop:
    mov EAX, sdword_array[ESI * TYPE sdword_array]
    call DisplayFormatted
    inc ESI
    loop SDWordLoop
    ret
DisplaySDWordArray ENDP

DisplayDWordArray PROC
    mov EDX, OFFSET dword_title
    call WriteString
    
    ; Using loop and TYPE
    mov ESI, 0
    mov ECX, LENGTHOF dword_array
DWordLoop:
    mov EAX, dword_array[ESI * TYPE dword_array]
    call WriteDec
    mov EDX, OFFSET asterisk
    call WriteString
    call Crlf
    inc ESI
    loop DWordLoop
    ret
DisplayDWordArray ENDP

DisplayFormatted PROC
    call WriteInt
    mov EDX, OFFSET asterisk
    call WriteString
    call Crlf
    ret
DisplayFormatted ENDP

DisplayFirstLast PROC
    mov EDX, OFFSET first_last_title
    call WriteString
    
    ; SBYTE array first and last
    movsx EAX, sbyte_array[0]
    call WriteInt
    call Crlf
    movsx EAX, sbyte_array[4]
    call WriteInt
    call Crlf
    
    ; SWORD array first and last
    movsx EAX, sword_array[0]
    call WriteInt
    call Crlf
    movsx EAX, sword_array[18]
    call WriteInt
    call Crlf
    
    ; SDWORD array first and last
    mov EAX, sdword_array[0]
    call WriteInt
    call Crlf
    mov EAX, sdword_array[19 * TYPE sdword_array]
    call WriteInt
    call Crlf
    
    ; DWORD array first and last
    mov EAX, dword_array[0]
    call WriteDec
    call Crlf
    mov EAX, dword_array[19 * TYPE dword_array]
    call WriteDec
    call Crlf
    ret
DisplayFirstLast ENDP

END main
